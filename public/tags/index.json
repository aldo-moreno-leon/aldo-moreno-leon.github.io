[{"content":"Ya dos años desde que subí un post en el blog, vuelvo a reactivarlo para compartir algunos conocimientos que pueden ser útiles.\nNo entraré en detalles de lo que es un Cross-Site Scripting ni tampoco en payloads, aquí voy a mostrar mi manera de como expandir un poco mi área de búsqueda de XSS.\nConocer el sitio Lo primero que realizo al comenzar mi caza de XSS es conocer el sitio al que se está testeando. Esto es saber donde hay entradas de datos como buscadores de productos, de posts, de FAQ, cualquier buscador que se encuentre. Al igual que si hay campos para agregar comentarios, reseñas, notas, títulos, entre otros datos de entrada. Es bueno observar siempre la dirección URL para ver que parámetros se muestran y si es posible inyectar payloads ahí.\nUn punto importante es saber como un usuario interactúa con el sitio web, que modelo de negocio maneja, así se puede dar una idea de los puntos de inyección que puede haber. Quizá existan formularios que se envíen al soporte del sitio y ahí conviene inyectar payloads de Blind XSS. O quizá sea un comercio en el que cada producto tenga una sección de comentarios donde es evidente el punto de inyección para explotar Stored XSS.\nUn tip que sirve para conocer mejor el sitio web es utilizar la extensión de navegadores Wappalyzer, el cual nos sirve para saber que lenguajes y tecnologías utiliza el sitio. Nos será útil con los métodos que mostraré más adelante.\nEse es el primer paso para comenzar mi búsqueda, siempre analizo bien el lugar que voy a testear.\nGoogle dorking El buscador de google es una gran herramienta para encontrar puntos de inyección que están ocultos o se nos pasan por completo al navegar por el sitio.\nEs muy fácil, te mostraré las que utilizo normalmente:\n1 2 3 4 5 6 7 site:*.yahoo.com ext:php site:*.yahoo.com inurl:php -www site:*.yahoo.com ext:asp site:*.yahoo.com inurl:aspx site:*.yahoo.com inurl:jsp site:*.yahoo.com inurl:cat= site:*.yahoo.com inurl:id= Se pueden hacer tantas variaciones como se quiera, es cuestión de agregarle un poco de imaginación y saber como está desarrollado el sitio.\n1.- Utilizando Google dorks.\rWayback Machine Otra herramienta sumamente útil para encontrar puntos de inyección ocultos o dificiles de encontrar es Waybackmachine.\nLo único que se debe hacer es usar una URL elaborada de manera que arroje los resultados deseados.\n1 http://web.archive.org/cdx/search/cdx?url=yahoo.com/*\u0026amp;output=text\u0026amp;fl=original\u0026amp;collapse=urlkey\u0026amp;from= De esta manera arroja tantos resultados como estén registrados en Waybackmachine. La tarea siguiente sería filtrar con el buscador del navegador.\n2.- Resultados de Waybackmachine.\rParámetros ocultos Esta sugerencia es un plus en este post y el cual me ha servido en múltiples ocasiones para encontrar parámetros ocultos.\nCuando navego por un sitio web y veo páginas con extensión de PHP, JSP, ASP, ASPX, etc. procedo a juguetear con los parámetros de la URI ya sea los que se manejan visualmente en la página o los que descubro utilizando una herramienta para detectar parámetros utilizados por esa misma página.\nArjun es una herramienta desarrollada por Somdev Sangwan que te permite saber si hay parámetros utilizables ya sean del tipo GET, POST, JSON y XML.\nArjun: https://github.com/s0md3v/Arjun 1 arjun -u https://api.example.com/endpoint -m GET Conclusión Esta es la manera en que me dirijo para buscar vulnerabilidades XSS, probablemente existan otros métodos que funcionen con más eficacia e incluso haya algunos más que se me han pasado pero el objetivo es mostrar lo que me ha sido útil y que puede funcionarles a ustedes también.\n“Si ayudas en la red, los demás también te ayudarán”. – Johan Manuel Mendez","description":"Como encontrar vulnerabilidades de Cross-Site Scripting.","id":12,"section":"posts","tags":["XSS"],"title":"Tips para encontrar vulnerabilidades XSS","uri":"https://desert-bunker.net/2023/06/tips-para-encontrar-vulnerabilidades-xss/"},{"content":"¿Qué es SayCheese? SayCheese es una herramienta que captura fotografías de un dispositivo de manera remota, ya sean dispositivos móviles u ordenadores, logrando el cometido por un link generado con ngrok y enviado a la víctima.\n¿Como funciona? La herramienta utiliza Ngrok mediante el método Port-Forwarding para generar el link malicioso el cual se envía a la víctima. Una vez la víctima abre el link en su navegador, se le solicitará permisos para utilizar la cámara para lo cual utiliza la función MediaDevices.getUserMedia() incorporada en el código javascript del archivo index.php.\nAl aceptar los permisos, SayCheese comienza a obtener las fotografías y almacenarlas en la carpeta llamada images.\nInstalación Para instalar SayCheese es muy simple, tan solo tienes que ejecutar en la terminal los siguientes comandos:\n1 2 3 4 git clone https://github.com/Technicalheadquarter/saycheese cd saycheese chmod +x saycheese.sh ./saycheese.sh En el caso de que la herramienta solicite instalar httrack la cual es una dependencia para su funcionamiento, se ejecuta lo siguiente:\n1 apt-get install httrack Usando SayCheese Ejecutamos la herramienta y nos muestra la presentación con dos opciones para crear el phishing que se mostrará a la víctima. En este caso elegimos la primera opción:\n1.- Portada de SayCheese y las opciones de phishing.\rLuego nos muestra que sitio web queremos utilizar como phishing, nosotros utilizaremos el que está por default de Snapchat, tan solo dar enter se selecciona:\n2.- Selección de website para phishing.\rAhora ngrok comienza a generar el link malicioso, si SayCheese no detecta ngrok, lo descarga automáticamente y se genera el link el cual debe ser abierto en el navegador de la víctima:\n3.- Ngrok genera el link malicioso.\rEn el navegador del dispositivo objetivo, ya sea un móvil u ordenador, se abre el link malicioso y se muestra la página de snapchat y la solicitud de permisos:\n4.- Página de snapchat y solicitud de permiso.\rAl momento de que la víctima abra el link malicioso, SayCheese te muestra que el link ha sido abierto y una vez que se acepta la solicitud de permiso, la cámara del dispositivo comienza a tomar fotografías y guardarlas en la carpeta images:\n5.- Víctima abre el link y acepta el permiso.\rY aquí se muestran las fotografías capturadas en la carpeta images:\n6.- Fotografías almacenadas en images.\rConclusión SayCheese es una interesante herramienta con la cual jugar. Claro está que es un poco difícil que el objetivo caiga en la trampa debido al permiso de uso de la cámara, pero con creatividad nada es imposible. ;)\n\u0026ldquo;La tarea del hacker no es destruir, sino utilizar sus conocimientos en favor de la libertad y la igualdad social\u0026rdquo;. – Johan Manuel Mendez ","description":"Una herramienta que es capaz de capturar fotografías utilizando la cámara de manera remota.","id":13,"section":"posts","tags":["phishing"],"title":"SayCheese: captura fotografías de un dispositivo remotamente","uri":"https://desert-bunker.net/2021/05/saycheese-captura-fotograf%C3%ADas-de-un-dispositivo-remotamente/"},{"content":"Hace un tiempo escribí un write-up acerca de como fui capaz de leer archivos locales provenientes del servidor de un servicio web llamado Downnotifier y para poder realizar tal acción, se explotó una vulnerabilidad llamada Server Side Request Forgery.\nEl write-up originalmente fue escrito en inglés por medio de la plataforma Openbugbounty, pero ahora lo escribo mediante este blog y traducida al español.\nHola chicos, este es mi primer write-up y me gustaría compartirlo con la comunidad de bug bounty, es sobre un SSRF que encontré hace algunos meses.\nDownNotifier tiene un programa de recompensas en Openbugbounty, entonces decidí darle un vistazo a https://www.downnotifier.com. Cuando navegué por el sitio web, me di cuenta de un campo para entrada de texto de tipo URL y rapidamente la vulnerabilidad SSRF vino a mi mente.\nObteniendo XSPA La primer actividad por realizar es agregar http://127.0.0.1:22 en el campo de texto \u0026ldquo;Website URL\u0026rdquo;.\nDespués seleccionar \u0026ldquo;When the site does not contain a specific text\u0026rdquo; y escribir algún texto aleatorio.\n1.- Sección de registro del sitio web.\rEnvié esa solicitud y seguidamente dos correos electrónicos llegaron a mi bandeja de entrada unos minutos después. El primero para alertar que un sitio web está siendo monitoreado y el segundo correo para alertar que el sitio web está fuera de servicio pero dentro de un archivo de HTML.\n2.- Bandeja de entrada con los correos.\r¿Y cual era la respuesta?\n3.- Versión de SSH.\rObteniendo Lectura de Archivos Locales A este punto ya estaba emocionado, pero eso no es suficiente para probar que se pueden obtener archivos con datos sensibles, entonces intenté el mismo proceso pero con algunos esquemas de URI como lo son file, ldap, gopher, ftp, ssh, pero ninguno dió resultado.\n4.- El esquema FILE no es aceptado.\rEstuve pensando como podría hacer un bypass a ese filtro y recordé un write-up mencionando un bypass usando una redirección con la cabezera Location en un archivo de PHP alojado en tu propio servidor.\n5.- Archivo PHP.\rAlojé el archivo de PHP con el código mostrado en la imagen anterior y se procedió a realizar el mismo proceso registrando un sitio web para monitorear.\n6.- Redirección a la URI file:///etc/passwd.\rUnos minutos después un correo electrónico llegó a la bandeja de entrada con un archivo HTML.\n7.- Correo con la respuesta.\rY la respuesta fue\u0026hellip;\n8.- Contenido de /etc/passwd.\rReporté la vulnerabilidad SSRF al soporte de DownNotifier y ellos arreglaron el fallo muy rápido.\nQuiero agradecer al soporte de DownNotifier porque ellos fueron muy amables en nuestra comunicación y me permitieron publicar el presente write-up. También quiero agradecer al bug bounty hunter quien escribió el write-up en el cual utilizó la técnica de redirección con la cabezera Location.\nWrite-up: https://medium.com/@elberandre/1-000-ssrf-in-slack-7737935d3884 \u0026ldquo;No temo a los ordenadores; lo que temo es quedarme sin ellos\u0026rdquo;. – Isaac Asimov","description":"Write-up sobre una vulnerabilidad en el sitio web DownNotifier","id":14,"section":"posts","tags":["bugbounty","SSRF"],"title":"SSRF: leyendo archivos locales del servidor de Downnotifier","uri":"https://desert-bunker.net/2021/04/ssrf-leyendo-archivos-locales-del-servidor-de-downnotifier/"},{"content":"Desert Bunker es el nombre que decidimos ponerle a este pequeño blog que se utilizará como un espacio para generar conocimientos y por supuesto compartirlos.\nLa idea comenzó como una manera de dejar plasmado los conocimientos que tenemos mi compañero NoSoyHacker404 y un servidor C0wb0y. Al mismo tiempo que depositamos nuestros aprendizajes en el blog, también estarán a la consulta de cualquier persona que sea lo suficientemente curiosa como para leer sobre tecnología y hacking.\nEste es nuestro pequeño bunker desarrollado desde el desierto para aportar nuestro granito de arena a la comunidad de Internet que siempre nos ha ayudado en nuestro desarrollo de habilidades.\n¡Bienvenidos!\n\u0026ldquo;No se trata de levantarse, sino de tropezar… tropezar en la dirección adecuada. Ese es el verdadero camino para avanzar\u0026rdquo;. – Mr. Robot ","description":"Hello World!","id":15,"section":"posts","tags":null,"title":"Desert Bunker","uri":"https://desert-bunker.net/2021/04/desert-bunker/"},{"content":"Desert Bunker\rDesert Bunker nace como un pequeño proyecto para compartir nuestros conocimientos con la comunidad compuesta por todos aquellos entusiastas que nos han ayudado por medio de Internet, ya sean en artículos, blogs, chats, foros, videos, etc. Estamos profundamente agradecidos con los conocimientos que nos han aportado y es por eso que hemos decidido brindar nuestro pequeño granito de arena a todo aquel que guste de experimentar con la seguridad y la tecnología.\nNo poseemos conocimientos avanzados de hacking o sobre tecnología pero lo poco que podemos aportar, lo hacemos con mucho gusto.\n\u0026ldquo;Dime y lo olvido, enséñame y lo recuerdo, involúcrame y lo aprendo”. – Benjamin Franklin ","description":"Desert Bunker","id":16,"section":"","tags":null,"title":"Acerca de nosotros","uri":"https://desert-bunker.net/acerca-de/"}]